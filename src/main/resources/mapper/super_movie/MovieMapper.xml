<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.super_movie.mapper.MovieMapper">
    <select id="findActorById" resultType="com.example.super_movie.entity.Person" parameterType="java.lang.Integer" >
        SELECT person.id,person.name,person.sex,person.born,person.info
        FROM person_movie LEFT JOIN person on person_movie.person_id=person.id
        WHERE person_movie.movie_id = #{id} AND person_movie.job=3
    </select>
    <select id="findDirectorById" resultType="com.example.super_movie.entity.Person" parameterType="java.lang.Integer" >
        SELECT person.id,person.name,person.sex,person.born,person.info
        FROM person_movie LEFT JOIN person on person_movie.person_id=person.id
        WHERE person_movie.movie_id = #{id} AND person_movie.job=1
    </select>
    <select id="findScreenwriterById" resultType="com.example.super_movie.entity.Person" parameterType="java.lang.Integer" >
        SELECT person.id,person.name,person.sex,person.born,person.info
        FROM person_movie LEFT JOIN person on person_movie.person_id=person.id
        WHERE person_movie.movie_id = #{id} AND person_movie.job=2
    </select>
    <select id="findKindByMovieId" resultType="String" parameterType="java.lang.Integer" >
        select  kind
        from kind_movie
        where movie_id = #{movieId}
    </select>
    <select id="findLanguageByMovieId" resultType="String" parameterType="java.lang.Integer" >
        select  language
        from language
        where movie_id = #{movieId}
    </select>
    <insert id="addMovie">
        insert into movie (name,time,country,length,info)
        values (#{name},#{time},#{country},#{length},#{info})
    </insert>
    <select id="getAvgScoreAndNumByMovieId" resultType="java.util.Map" parameterType="java.lang.Integer">
    SELECT IFNULL(avg(score),0) as avg,count(*) as sum
    FROM movie_comment
    WHERE movie_id=#{movieId}
    </select>
</mapper>
